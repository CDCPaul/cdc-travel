// Firebase Storage 보안 규칙 (관리자 전용)
// Firebase Console → Storage → Rules에서 이 규칙으로 교체하세요

rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // eBooks 폴더 - 관리자만 업로드 가능, 모든 인증된 사용자 읽기 가능
    match /ebooks/{fileName} {
      allow read: if request.auth != null;
      allow write, delete: if request.auth != null 
        && (
          request.auth.token.email == 'dev@cebudirectclub.com' ||
          request.auth.token.email == 'admin@cebudirectclub.com' ||
          request.auth.token.role == 'admin'
        );
    }
    
    // 다른 모든 파일 - 인증된 사용자만
    match /{allPaths=**} {
      allow read, write: if request.auth != null;
    }
  }
}
